# Chapter 20 ë°ì´í„°ë² ì´ìŠ¤ ì…ì¶œë ¥(JDBC)

<aside>
ğŸ’¡ JDBCë€ ë¬´ì—‡ì¸ê°€ìš”?

</aside>

## 20.1 JDBC(java Database Connectivity) ê°œìš”

- `DriverManager`: ë“œë¼ì´ë²„ ê´€ë¦¬
- `Connection`:  êµ¬í˜„ê°ì²´ ìƒì„±, íŠ¸ëœì­ì…˜ ì²˜ë¦¬ ë° DBì—°ê²° ì¢…ë£Œì‹œ ì‚¬ìš©
    - `Statement`: DDL,DML ì‹¤í–‰(ì •ì )
    - `PreparedStatement`: DDL, DML ì‹¤í–‰(ë§¤ê°œë³€ìˆ˜í™”ëœ SQL)
    - `CallableStatement`: í”„ë¡œì‹œì €ì™€ í•¨ìˆ˜ í˜¸ì¶œ
- `ResultSet`: ë°ì´í„°ë¥¼ ì½ì„ ë•Œ ì‚¬ìš©

## 20.2 DBMS ì„¤ì¹˜

## 20.3 Client Tool ì„¤ì¹˜

## 20.4 DB êµ¬ì„±

## 20.5 DB ì—°ê²°

- ì—°ê²°ì •ë³´
    1. DBMS IP
    2. DBMS Port
    3. User, Password
    4. DB name
- DB ì¢…ë¥˜ì— ë”°ë¥¸ Driver ì‚¬ìš©

```java
Connection conn = null;
Class.forName("oracle.jdbc.OracleDriver");
conn = DriverManager.getConnection("jdbc:oracle:thin:@localhost:1521/DBëª…", "USER", "PASSWORD"); //ì—°ê²°

conn.close(); //ì¢…ë£Œ
```

## 20.6 ë°ì´í„° ì €ì¥ insert

```java
/*SQL ì‘ì„±*/
String sql = new StringBuilder()
  .append("INSERT INTO users (userid, username, userpassword, userage, useremail)")
  .append("VALUES (?, ?, ?, ?, ?)")
  .toString();

PreparedStatement pstmt = conn.prepareStatement(sql); // PreparedStatement ìƒì„±

/* ëŒ€ì… */
pstmt.setString(1, "winter");
pstmt.setString(2, "í•œê²¨ìš¸");
pstmt.setString(3, "12345");
pstmt.setInt(4, 25);
pstmt.setString(5, "winter@mycompany.com");

int rows = pstmt.executeUpdate(); //SQLë¬¸ ì‹¤í–‰->insertëœ í–‰ì˜ ìˆ˜

pstmt.close(); // ë©”ëª¨ë¦¬ í•´ì œ
```

## 20.7 ë°ì´í„° ìˆ˜ì • update

```java
/*SQL ì‘ì„±*/
String sql = new StringBuilder()
  .append("UPDATE users SET ")
  .append("btitle=?, ")
  .append("Bcontent=?, ")
  .append("bfilename=?, ")
  .append("bfiledata=?, ")
  .append("WhERE bon=?")
  .toString();

PreparedStatement pstmt = conn.prepareStatement(sql); // PreparedStatement ìƒì„±

/* ëŒ€ì… */
pstmt.setString(1, "ëˆˆì‚¬ëŒ");
pstmt.setString(2, "ëˆˆìœ¼ë¡œ ë§Œë“  ì‚¬ëŒ");
pstmt.setString(3, "snowman.jpg");
pstmt.setBlob(4, new FileInputStream("src/ch20/oracle/sec07/snowman.jpg"));
pstmt.setString(5, 3);

int rows = pstmt.executeUpdate(); //SQLë¬¸ ì‹¤í–‰->ì—…ë°ì´íŠ¸ëœ í–‰ì˜ ìˆ˜

pstmt.close(); // ë©”ëª¨ë¦¬ í•´ì œ
```

## 20.8 ë°ì´í„° ì‚­ì œ delete

```java
String sql ="DELETE FROM boards WHERE bwriter=?";
PreparedStatement pstmt = conn.prepareStatement(sql); // PreparedStatement ìƒì„±
pstmt.setString(1, "winter");
int rows = pstmt.executeUpdate(); //SQLë¬¸ ì‹¤í–‰->ì‚­ì œëœ í–‰ì˜ ìˆ˜
```

## 20.9 ë°ì´í„° ì½ê¸° select

```java
String sql ="SELECT userid, username, userpassword, userage, useremail " +
"FROM users "+
"WHERE userid=?";
PreparedStatement pstmt = conn.prepareStatement(sql); // PreparedStatement ìƒì„±
pstmt.setString(1, "winter");
ResultSet rs = pstmt.executeQuery();
```

- `ResultSet` ì»¤ì„œê°€ ìˆëŠ” í–‰ì˜ ë°ì´í„°ë§Œ ì½ì„ ìˆ˜ ìˆë‹¤.
    - next() ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•´ ì»¤ì„œ ì´ë™ì´ ê°€ëŠ¥

## 20.10 í”„ë¡œì‹œì €ì™€ í•¨ìˆ˜ í˜¸ì¶œ

### í”„ë¡œì‹œì € í˜¸ì¶œ

```java
String sql = "{ call í”„ë¡œì‹œì €ëª…(?,?, ..., ?) }";
CallableStatement cstmt = conn.prepareCall(sql);
cstmt.setString(1, "ê°’"); //ì¸ì1
cstmt.setString(2, "ê°’"); //ì¸ì2 
...
cstmt.registerOutParameter(n, E);

cstmt.execute(); // í˜¸ì¶œ

E result = cstmt.getInt(n); //ë¦¬í„´ ê°’ ì–»ê¸°

cstmt.close(); //ë©”ëª¨ë¦¬ í•´ì œ
```

### í•¨ìˆ˜ í˜¸ì¶œ

```java
String sql = "{ ? = call í•¨ìˆ˜ëª…(?,?, ..., ?) }";
CallableStatement cstmt = conn.prepareCall(sql);
cstmt.registerOutParameter(1, E);
cstmt.setString(2, "ê°’"); //ì¸ì1
cstmt.setString(3, "ê°’"); //ì¸ì2 
...
cstmt.setString(n, "ê°’"); //ì¸ìn 

cstmt.execute(); // í˜¸ì¶œ

E result = cstmt.getInt(1); //ë¦¬í„´ ê°’ ì–»ê¸°

cstmt.close(); //ë©”ëª¨ë¦¬ í•´ì œ
```

## 20.11 íŠ¸ëœì­ì…˜ ì²˜ë¦¬

- `conn.commit();`
- `conn.rollback();`

## 20.12 ê²Œì‹œíŒ êµ¬í˜„